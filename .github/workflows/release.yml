# Auto-generated by Cimas: Do not edit it manually!
# See https://github.com/metanorma/cimas
name: release

on:
  workflow_dispatch:
    inputs:
      next_version:
        description: |
          Next release version. Possible values: x.y.z, major, minor, patch or pre|rc|etc
        required: true
        default: 'skip'
  repository_dispatch:
    types: [ do-release ]

jobs:
  release:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4
    - name: Set up Ruby
      uses: ruby/setup-ruby@v1
      with:
        ruby-version: '3.3'
        bundler-cache: true
    - name: package contents
      run: capsium package pack -f package/

    - name: Upload binaries to release
      uses: svenstaro/upload-release-action@v2
      with:
        repo_token: ${{ secrets.GITHUB_TOKEN }}
        file: '*.cap'
        asset_name: published
        tag: ${{ github.ref }}
        overwrite: true
        body: "This is my release text"

    #     with:
    #   next_version: ${{ github.event.inputs.next_version }}
    # secrets:
    #   rubygems-api-key: ${{ secrets.METANORMA_CI_RUBYGEMS_API_KEY }}
    #   pat_token: ${{ secrets.METANORMA_CI_PAT_TOKEN }}
